$(document).ready(function(){function r(e){function a(r,e,a){var o,n,t={};for(o in e)n=e[o],o in r&&(r[o]===n||o in t&&t[o]===n)||(r[o]=a?a(n):n);return r}if(!e||"object"!=typeof e||"[object Function]"===Object.prototype.toString.call(e))return e;if(e.nodeType&&"cloneNode"in e)return e.cloneNode(!0);if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp)return new RegExp(e);var o,n,t;if(e instanceof Array)for(o=[],n=0,t=e.length;t>n;++n)n in e&&o.push(r(e[n]));else o=e.constructor?new e.constructor:{};return a(o,e,r)}for(var e=10,a=e-1,o=30,n=1,t=4,c=new Array(o),l=0;o>l;l++)c[l]=new Array(o);for(var i=new Array(o),l=0;o>l;l++)i[l]=new Array(o);for(var f=new Array(o),l=0;o>l;l++)f[l]=new Array(o);for(var s=new Array(o),l=0;o>l;l++)s[l]=new Array(o);var u;$("#back").hide();var v=function(){$(".turn .name").text("Player"+n),$("#player_color").removeClass(),$("#player_color").addClass("player"+n);var r=n>1?n-1:t;$("#back").removeClass(),$("#back").addClass("player"+r)},d=function(){n++,n>t&&(n=1),v()},w=function(){n--,0>=n&&(n=t),v()},h=function(){$("#back").hide(),""!=$("#numOfPlayer").val()&&(t=$(".numberOfPlayer .selected").html()),""!=$("#size").val()&&(e=$(".size .selected").html()),n=1,v();for(var r=0;e>r;r++)for(var a=0;e>a;a++)c[r][a]=0,f[r][a]=0;for(var r=0;e>r;r++)for(var a=0;e>a;a++)i[r][a]=!1,s[r][a]=!1;for(var r=0;e>r;r++)i[0][r]=!0;for(var r=0;e>r;r++)i[r][0]=!0;for(var r=0;e>r;r++)i[r][e-1]=!0;for(var r=0;e>r;r++)i[e-1][r]=!0;$("#wrapper").html("");for(var o=$("#wrapper").width(),l=2,u=Math.floor(o/e)-2*l,r=0;e>r;r++)for(var a=0;e>a;a++)$("#wrapper").append('<div data-row="'+r+'" data-column="'+a+'" class="check"></div>'),$(".check").css({width:u,height:u})},p=function(){for(var r=0;e>r;r++)for(var a=0;e>a;a++)i[r][a]=!1};$(window).resize(function(){var r=$("#wrapper").width(),a=2,o=Math.floor(r/e)-2*a;$(".check").css({width:o,height:o})}),h(),$(document).on("click tap",".numberOfPlayer li",function(){$(".numberOfPlayer li").removeClass(),$(this).addClass("selected")}),$(document).on("click tap",".size li",function(){$(".size li").removeClass(),$(this).addClass("selected")});var m,y;$(document).on("click tap",".check",function(){function o(){h++}function t(){g--}function l(){g++}function v(r,a){return 0>r||r>e||0>a||a>e?!0:!1}function w(r,o){h=m,g=y;var n=C-1;"up"==r?0>m-n&&(n=m):"down"==r&&m+n>a&&(n=a-m),"left"==o?0>y-n&&(n=y):"right"==o&&y+n>a&&(n=a-y),console.log(n),"up"==r?h=m-n:"down"==r&&(h=m+n),"left"==o?g=y-n:"right"==o&&(g=y+n),h>e&&(h=e),g>e&&(g=e),0>h&&(h=0),0>g&&(g=0)}if(m=$(this).data("row"),y=$(this).data("column"),1==i[m][y]){f=r(c),s=r(i),$("#back").show(),u=this,$(this).addClass("player"+n),c[m][y]=n;var h,g;h=m,can=!0;for(var k=0;m>k;k++)0==c[k][y]&&(can=!1);if(can){do{if(0!=m&&0==c[m-1][y])break;if(h++,h>=e)break}while(0!=c[h][y]);e>h&&(i[h][y]=!0)}h=m,can=!0;for(var k=e-1;k>m;k--)0==c[k][y]&&(can=!1);if(can){do{if(m!=e-1&&0==c[m+1][y])break;if(h--,0>h)break}while(0!=c[h][y]);h>=0&&(i[h][y]=!0)}g=y,can=!0;for(var k=0;y>k;k++)0==c[m][k]&&(can=!1);if(can){do{if(0!=y&&0==c[m][y-1])break;if(g++,g>=e)break}while(0!=c[m][g]);e>g&&(i[m][g]=!0)}g=y,can=!0;for(var k=e-1;k>y;k--)0==c[m][k]&&(can=!1);if(can){do{if(y!=e-1&&0==c[m][y+1])break;if(g--,0>g)break}while(0!=c[m][g]);g>=0&&(i[m][g]=!0)}var b=new Array(8),A=0,C=4,z=!1;w("up","left"),A=0;for(var k=0;7>k&&(c[h][g]==n?(A++,A==C&&(z=!0)):A=0,o(),l(),!v(h,g));k++);console.log(z),console.log("-------------*************************-------------"),w("up","right"),A=0,console.log("row",m),console.log("column",y);for(var k=0;7>k&&(console.log("tmp_row",h),console.log("tmp_column",g),console.log("tmp_row",h),console.log("turn",n),console.log("count",A),c[h][g]==n?(A++,A==C&&(z=!0)):A=0,o(),t(),!v(h,g));k++);w("","left"),A=0;for(var k=0;7>k&&(c[h][g]==n?(A++,A==C&&(z=!0)):A=0,l(),!v(h,g));k++);w("up",""),A=0;for(var k=0;7>k&&(c[h][g]==n?(A++,A==C&&(z=!0)):A=0,o(),!v(h,g));k++);z?(swal({title:"Congratulations!",text:"Player"+n+" won the game!"}),p(),$("#back").hide()):d(),console.log(b),i[m][y]=!1,console.log("status",c)}}),$("#new_game").click(function(){$("#numOfPlayer").val()<=1?alert("At least 2 players"):$("#size").val()<5||$("#size").val()>30?alert("Range of size: 5-30"):window.confirm("Are you sure to start a new game?")&&h()}),$("#back").click(function(){return c=r(f),i=r(s),w(),$(u).removeClass("player"+n),$("#back").hide(),!1})});