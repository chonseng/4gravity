$(document).ready(function(){function r(e){function a(r,e,a){var o,n,t={};for(o in e)n=e[o],o in r&&(r[o]===n||o in t&&t[o]===n)||(r[o]=a?a(n):n);return r}if(!e||"object"!=typeof e||"[object Function]"===Object.prototype.toString.call(e))return e;if(e.nodeType&&"cloneNode"in e)return e.cloneNode(!0);if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp)return new RegExp(e);var o,n,t;if(e instanceof Array)for(o=[],n=0,t=e.length;t>n;++n)n in e&&o.push(r(e[n]));else o=e.constructor?new e.constructor:{};return a(o,e,r)}for(var e=10,a=30,o=1,n=4,t=new Array(a),c=0;a>c;c++)t[c]=new Array(a);for(var l=new Array(a),c=0;a>c;c++)l[c]=new Array(a);for(var i=new Array(a),c=0;a>c;c++)i[c]=new Array(a);for(var f=new Array(a),c=0;a>c;c++)f[c]=new Array(a);var s;$("#back").hide();var u=function(){$(".turn .name").text("Player"+o),$("#player_color").removeClass(),$("#player_color").addClass("player"+o);var r=o>1?o-1:n;$("#back").removeClass(),$("#back").addClass("player"+r)},v=function(){o++,o>n&&(o=1),u()},d=function(){o--,0>=o&&(o=n),u()},w=function(){$("#back").hide(),""!=$("#numOfPlayer").val()&&(n=$(".numberOfPlayer .selected").html()),""!=$("#size").val()&&(e=$(".size .selected").html()),o=1,u();for(var r=0;e>r;r++)for(var a=0;e>a;a++)t[r][a]=0,i[r][a]=0;for(var r=0;e>r;r++)for(var a=0;e>a;a++)l[r][a]=!1,f[r][a]=!1;for(var r=0;e>r;r++)l[0][r]=!0;for(var r=0;e>r;r++)l[r][0]=!0;for(var r=0;e>r;r++)l[r][e-1]=!0;for(var r=0;e>r;r++)l[e-1][r]=!0;$("#wrapper").html("");for(var c=$("#wrapper").width(),s=2,v=Math.floor(c/e)-2*s,r=0;e>r;r++)for(var a=0;e>a;a++)$("#wrapper").append('<div data-row="'+r+'" data-column="'+a+'" class="check"></div>'),$(".check").css({width:v,height:v})},h=function(){for(var r=0;e>r;r++)for(var a=0;e>a;a++)l[r][a]=!1};$(window).resize(function(){var r=$("#wrapper").width(),a=2,o=Math.floor(r/e)-2*a;$(".check").css({width:o,height:o})}),w(),$(document).on("click tap",".numberOfPlayer li",function(){$(".numberOfPlayer li").removeClass(),$(this).addClass("selected")}),$(document).on("click tap",".size li",function(){$(".size li").removeClass(),$(this).addClass("selected")});var p,m;$(document).on("click tap",".check",function(){function a(){w++}function n(){y--}function c(){y++}function u(r,a){var o=e-1;return 0>r||r>o||0>a||a>o?!0:!1}function d(r,a){w=p,y=m;var o=A-1,n=e-1;"up"==r?0>p-o&&(o=p):"down"==r&&p+o>n&&(o=n-p),"left"==a?0>m-o&&(o=m):"right"==a&&m+o>n&&(o=n-m),console.log(o),"up"==r?w=p-o:"down"==r&&(w=p+o),"left"==a?y=m-o:"right"==a&&(y=m+o),w>e&&(w=e),y>e&&(y=e),0>w&&(w=0),0>y&&(y=0)}if(p=$(this).data("row"),m=$(this).data("column"),1==l[p][m]){i=r(t),f=r(l),$("#back").show(),s=this,$(this).addClass("player"+o),t[p][m]=o;var w,y;w=p,can=!0;for(var g=0;p>g;g++)0==t[g][m]&&(can=!1);if(can){do{if(0!=p&&0==t[p-1][m])break;if(w++,w>=e)break}while(0!=t[w][m]);e>w&&(l[w][m]=!0)}w=p,can=!0;for(var g=e-1;g>p;g--)0==t[g][m]&&(can=!1);if(can){do{if(p!=e-1&&0==t[p+1][m])break;if(w--,0>w)break}while(0!=t[w][m]);w>=0&&(l[w][m]=!0)}y=m,can=!0;for(var g=0;m>g;g++)0==t[p][g]&&(can=!1);if(can){do{if(0!=m&&0==t[p][m-1])break;if(y++,y>=e)break}while(0!=t[p][y]);e>y&&(l[p][y]=!0)}y=m,can=!0;for(var g=e-1;g>m;g--)0==t[p][g]&&(can=!1);if(can){do{if(m!=e-1&&0==t[p][m+1])break;if(y--,0>y)break}while(0!=t[p][y]);y>=0&&(l[p][y]=!0)}var k=new Array(8),b=0,A=4,C=!1;d("up","left"),b=0;for(var g=0;7>g&&(t[w][y]==o?(b++,b==A&&(C=!0)):b=0,a(),c(),!u(w,y));g++);console.log(C),console.log("-------------*************************-------------"),d("up","right"),b=0,console.log("row",p),console.log("column",m);for(var g=0;7>g&&(console.log("tmp_row",w),console.log("tmp_column",y),console.log("tmp_row",w),console.log("turn",o),console.log("count",b),t[w][y]==o?(b++,b==A&&(C=!0)):b=0,a(),n(),!u(w,y));g++);d("","left"),b=0;for(var g=0;7>g&&(t[w][y]==o?(b++,b==A&&(C=!0)):b=0,c(),!u(w,y));g++);d("up",""),b=0;for(var g=0;7>g&&(t[w][y]==o?(b++,b==A&&(C=!0)):b=0,a(),!u(w,y));g++);C?(swal({title:"Congratulations!",text:"Player"+o+" won the game!"}),h(),$("#back").hide()):v(),console.log(k),l[p][m]=!1,console.log("status",t)}}),$("#new_game").click(function(){$("#numOfPlayer").val()<=1?alert("At least 2 players"):$("#size").val()<5||$("#size").val()>30?alert("Range of size: 5-30"):window.confirm("Are you sure to start a new game?")&&w()}),$("#back").click(function(){return t=r(i),l=r(f),d(),$(s).removeClass("player"+o),$("#back").hide(),!1})});